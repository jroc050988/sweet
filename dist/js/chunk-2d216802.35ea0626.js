(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d216802"],{c373:function(e,t,o){"use strict";o.r(t);var l=o("7a23");const c={class:"container"},a={class:"adminInner"},d={class:"btnBox"},s={class:"pdtList"},r={class:"mt-4"},i=Object(l["createElementVNode"])("thead",null,[Object(l["createElementVNode"])("tr",null,[Object(l["createElementVNode"])("th",{width:"120"},"訂單日期"),Object(l["createElementVNode"])("th",{width:"360"},"訂單編號"),Object(l["createElementVNode"])("th",{width:"120"},"訂購人"),Object(l["createElementVNode"])("th",{width:"120"},"付款日期"),Object(l["createElementVNode"])("th",null,"備註"),Object(l["createElementVNode"])("th")])],-1),n={key:0},b={key:1},m={class:"btn-group"},p=["onClick"],O=["onClick"];function u(e,t,o,u,j,h){const V=Object(l["resolveComponent"])("Header"),N=Object(l["resolveComponent"])("OrderModal"),E=Object(l["resolveComponent"])("Loading"),g=Object(l["resolveComponent"])("DelModal");return Object(l["openBlock"])(),Object(l["createElementBlock"])(l["Fragment"],null,[Object(l["createVNode"])(V),Object(l["createElementVNode"])("div",c,[Object(l["createElementVNode"])("div",a,[Object(l["createElementVNode"])("div",d,[Object(l["createElementVNode"])("button",{type:"button",class:"btn btn-primary mr-2 border-start-0",onClick:t[0]||(t[0]=e=>h.openDelModal(!0))}," 刪除所有訂單 ")]),Object(l["createElementVNode"])("div",s,[Object(l["createElementVNode"])("table",r,[i,Object(l["createElementVNode"])("tbody",null,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(j.orderList,(t,o)=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("tr",{key:o},[Object(l["createElementVNode"])("td",null,Object(l["toDisplayString"])(e.$filter.getDate(1e3*t.create_at)),1),Object(l["createElementVNode"])("td",null,Object(l["toDisplayString"])(t.id),1),Object(l["createElementVNode"])("td",null,Object(l["toDisplayString"])(t.user.name),1),t.is_paid?(Object(l["openBlock"])(),Object(l["createElementBlock"])("td",n,Object(l["toDisplayString"])(t.paid_date),1)):(Object(l["openBlock"])(),Object(l["createElementBlock"])("td",b," 尚未付款 ")),Object(l["createElementVNode"])("td",null,Object(l["toDisplayString"])(t.message),1),Object(l["createElementVNode"])("td",null,[Object(l["createElementVNode"])("div",m,[Object(l["createElementVNode"])("button",{class:"btn btn-outline-primary btn-sm","data-bs-toggle":"modal","data-bs-target":"#Modal",onClick:Object(l["withModifiers"])(e=>h.openDetail(t),["prevent"])}," 編輯 ",8,p),Object(l["createElementVNode"])("button",{class:"btn btn-outline-danger btn-sm","data-bs-toggle":"modal","data-bs-target":"#delModal",onClick:e=>h.openDelModal(!1,t)}," 刪除 ",8,O)])])]))),128))])])]),Object(l["createVNode"])(N,{ref:"detail",data:j.orderDetail,onUpdata:h.updataOrder},null,8,["data","onUpdata"]),Object(l["createVNode"])(E,{isShow:j.isLoading},null,8,["isShow"]),Object(l["createVNode"])(g,{ref:"delModal",pdt:j.orderDetail,isAll:j.isAll,onDelProduct:h.delProduct,onDelAll:h.deleteAll},null,8,["pdt","isAll","onDelProduct","onDelAll"])])])],64)}var j=o("1985");const h={class:"modal fade orderModal",tabindex:"-1",ref:"modal"},V={class:"modal-dialog modal-xl",role:"document"},N={class:"modal-header"},E={class:"modalTitle"},g=Object(l["createElementVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),f={key:0,class:"modal-body"},y={class:"row"},v={class:"col-sm-4"},k={class:"mb-3"},D={for:"name",class:"form-label inputTitle"},M=Object(l["createTextVNode"])(" 訂購人姓名 "),w={class:"mb-3"},B={for:"email",class:"form-label inputTitle"},S=Object(l["createTextVNode"])(" 聯絡電子信箱 "),T={class:"mb-3"},L={for:"tel",class:"form-label inputTitle"},x=Object(l["createTextVNode"])(" 聯絡電話 "),C={class:"mb-3"},$={for:"add",class:"form-label inputTitle"},_=Object(l["createTextVNode"])(" 收件地址 "),A={class:"col-sm-8"},I={class:"orderDetailList mb-1"},U={class:"w-100"},J={class:"orderTitle"},P=Object(l["createElementVNode"])("td",null,"名稱",-1),q=Object(l["createElementVNode"])("td",{width:"80"},"原價",-1),F=Object(l["createElementVNode"])("td",{width:"80"},"售價",-1),H=Object(l["createElementVNode"])("td",{width:"60"},"數量",-1),z=Object(l["createElementVNode"])("td",{width:"80"},"小計",-1),G={key:0,width:"80"},K=Object(l["createElementVNode"])("td",{width:"80"},"刪除",-1),Q=["onUpdate:modelValue","onChange"],R={key:0},W=["onClick"],X={key:0},Y={colspan:"7",class:"text-left"},Z={class:"orderTotal"},ee={class:"orderItem"},te=Object(l["createElementVNode"])("p",{class:"title"},"總價",-1),oe={key:0,class:"orderItem red"},le=Object(l["createElementVNode"])("p",{class:"title"},"折扣",-1),ce={class:"orderItem"},ae=Object(l["createElementVNode"])("p",{class:"title"},"運費",-1),de={class:"orderItem"},se=Object(l["createElementVNode"])("p",{class:"title"},"結算",-1),re=Object(l["createElementVNode"])("div",{class:"modal-footer"},[Object(l["createElementVNode"])("button",{type:"button",class:"btn btn-outline-primary","data-bs-dismiss":"modal"}," 取消 "),Object(l["createElementVNode"])("button",{class:"btn btn-primary"}," 確定 ")],-1);function ie(e,t,o,c,a,d){const s=Object(l["resolveComponent"])("font-awesome-icon");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",h,[Object(l["createElementVNode"])("div",V,[Object(l["createElementVNode"])("form",{class:"modal-content border-0",onSubmit:t[4]||(t[4]=(...e)=>d.onSubmit&&d.onSubmit(...e))},[Object(l["createElementVNode"])("div",N,[Object(l["createElementVNode"])("p",E,[Object(l["createElementVNode"])("span",null,"訂單編號: "+Object(l["toDisplayString"])(o.data.id),1)]),g]),o.data.user?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",f,[Object(l["createElementVNode"])("div",y,[Object(l["createElementVNode"])("div",v,[Object(l["createElementVNode"])("div",k,[Object(l["createElementVNode"])("label",D,[Object(l["createVNode"])(s,{icon:"fa-solid fa-stroopwafel"}),M]),Object(l["withDirectives"])(Object(l["createElementVNode"])("input",{type:"text",class:"form-control",id:"name","onUpdate:modelValue":t[0]||(t[0]=e=>a.order.user.name=e)},null,512),[[l["vModelText"],a.order.user.name]])]),Object(l["createElementVNode"])("div",w,[Object(l["createElementVNode"])("label",B,[Object(l["createVNode"])(s,{icon:"fa-solid fa-stroopwafel"}),S]),Object(l["withDirectives"])(Object(l["createElementVNode"])("input",{type:"email",class:"form-control",id:"email","onUpdate:modelValue":t[1]||(t[1]=e=>a.order.user.email=e)},null,512),[[l["vModelText"],a.order.user.email]])]),Object(l["createElementVNode"])("div",T,[Object(l["createElementVNode"])("label",L,[Object(l["createVNode"])(s,{icon:"fa-solid fa-stroopwafel"}),x]),Object(l["withDirectives"])(Object(l["createElementVNode"])("input",{type:"text",class:"form-control",id:"tel","onUpdate:modelValue":t[2]||(t[2]=e=>a.order.user.tel=e)},null,512),[[l["vModelText"],a.order.user.tel]])]),Object(l["createElementVNode"])("div",C,[Object(l["createElementVNode"])("label",$,[Object(l["createVNode"])(s,{icon:"fa-solid fa-stroopwafel"}),_]),Object(l["withDirectives"])(Object(l["createElementVNode"])("input",{type:"text",class:"form-control",id:"add","onUpdate:modelValue":t[3]||(t[3]=e=>a.order.user.address=e)},null,512),[[l["vModelText"],a.order.user.address]])])]),Object(l["createElementVNode"])("div",A,[Object(l["createElementVNode"])("div",I,[Object(l["createElementVNode"])("table",U,[Object(l["createElementVNode"])("thead",null,[Object(l["createElementVNode"])("tr",J,[P,q,F,H,z,a.coupon?(Object(l["openBlock"])(),Object(l["createElementBlock"])("td",G,"折扣後")):Object(l["createCommentVNode"])("",!0),K])]),Object(l["createElementVNode"])("tbody",null,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(a.products,(e,t)=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("tr",{key:t},[Object(l["createElementVNode"])("td",null,Object(l["toDisplayString"])(e.product.title),1),Object(l["createElementVNode"])("td",null,Object(l["toDisplayString"])(e.product.origin_price),1),Object(l["createElementVNode"])("td",null,Object(l["toDisplayString"])(e.product.price),1),Object(l["createElementVNode"])("td",null,[Object(l["withDirectives"])(Object(l["createElementVNode"])("input",{type:"number","onUpdate:modelValue":t=>e.qty=t,onChange:t=>d.updataItem(e)},null,40,Q),[[l["vModelText"],e.qty]])]),Object(l["createElementVNode"])("td",null,Object(l["toDisplayString"])(e.total),1),a.coupon?(Object(l["openBlock"])(),Object(l["createElementBlock"])("td",R,Object(l["toDisplayString"])(e.final_total),1)):Object(l["createCommentVNode"])("",!0),Object(l["createElementVNode"])("td",null,[Object(l["createElementVNode"])("a",{href:"#",title:"刪除",class:"d-block",onClick:Object(l["withModifiers"])(t=>d.deleteItem(e),["prevent"])},[Object(l["createVNode"])(s,{icon:"fa-solid fa-trash-can"})],8,W)])]))),128)),a.coupon?(Object(l["openBlock"])(),Object(l["createElementBlock"])("tr",X,[Object(l["createElementVNode"])("td",Y,[Object(l["createVNode"])(s,{icon:"fa-solid fa-circle-check"}),Object(l["createTextVNode"])(" 已套用"+Object(l["toDisplayString"])(a.coupon.title)+'優惠券"'+Object(l["toDisplayString"])(a.coupon.code)+'"；折扣'+Object(l["toDisplayString"])(100-a.coupon.percent)+"% ",1)])])):Object(l["createCommentVNode"])("",!0)])])]),Object(l["createElementVNode"])("div",Z,[Object(l["createElementVNode"])("div",ee,[te,Object(l["createElementVNode"])("p",null,"$ "+Object(l["toDisplayString"])(a.origin_total),1)]),a.coupon?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",oe,[le,Object(l["createElementVNode"])("p",null,"– $ "+Object(l["toDisplayString"])(a.discount),1)])):Object(l["createCommentVNode"])("",!0),Object(l["createElementVNode"])("div",ce,[ae,Object(l["createElementVNode"])("p",null,"$ "+Object(l["toDisplayString"])(a.fare),1)]),Object(l["createElementVNode"])("div",de,[se,Object(l["createElementVNode"])("p",null,"$ "+Object(l["toDisplayString"])(a.finalTotal),1)])])])])])):Object(l["createCommentVNode"])("",!0),re],32)])],512)}var ne=o("8ad7"),be={data(){return{order:{},coupon:{},products:[],origin_total:0,fare:0,finalTotal:0,discount:0}},mixins:[ne["a"]],props:{data:{type:Object,defalut(){return{}}}},watch:{data(){this.origin_total=0,this.order=this.data,this.products=Object.values(this.data.products),Object.values(this.order.products).forEach(e=>{this.coupon=e.coupon}),this.count()}},methods:{updataItem(e){this.products.forEach((t,o)=>{t.id===e.id&&(this.products[o].total=e.qty*e.product.price,this.coupon&&(this.products[o].final_total=this.products[o].total*(e.coupon.percent/100)))}),this.count()},deleteItem(e){this.products.forEach((t,o)=>{t.id===e.id&&(this.products.splice(o,1),this.order.products=this.products)}),this.count()},count(){this.origin_total=0,this.finalTotal=0,this.products.forEach(e=>{this.origin_total+=e.total}),this.fare=this.origin_total>3e3?0:150,this.coupon?(this.products.forEach(e=>{this.finalTotal+=e.final_total}),this.finalTotal+=this.fare,this.discount=this.origin_total+this.fare-this.finalTotal):this.finalTotal=this.origin_total+this.fare},onSubmit(){this.$emit("updata",this.order),console.log(this.order),console.log(this.products)}}},me=o("6b0d"),pe=o.n(me);const Oe=pe()(be,[["render",ie]]);var ue=Oe,je=o("3a5e"),he=o("cb98"),Ve={data(){return{orderList:[],isLoading:!1,orderDetail:{},isAll:!1}},components:{Header:j["a"],OrderModal:ue,Loading:je["a"],DelModal:he["a"]},inject:["emitter"],methods:{openDetail(e){this.orderDetail=JSON.parse(JSON.stringify(e)),console.log(this.orderDetail),this.$refs.detail.showModal()},openDelModal(e,t){this.isAll=e,console.log(e),e||(this.orderDetail=t),this.$refs.delModal.showModal()},delProduct(e){if("allOrder"===e)this.deleteAll();else{this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/lili-testapi/admin/order/"+e.id;this.$http.delete(t).then(e=>{e.data.success?(this.$refs.delModal.hideModal(),this.getOrder(),this.isLoading=!1,this.emitter.emit("pushMessage",{style:"success",content:e.data.message,icon:""})):(this.emitter.emit("pushMessage",{style:"fail",content:e.data.message,icon:""}),this.$refs.delModal.hideModal(),this.isLoading=!1),console.log(e)}).catch(e=>{console.error(e)})}},getOrder(){this.isLoading=!0;const e="https://vue3-course-api.hexschool.io/api/lili-testapi/admin/orders";this.$http.get(e).then(e=>{e.data.success?(this.orderList=e.data.orders,console.log(e.data),this.isLoading=!1):(console.log("列表取得失敗"),this.isLoading=!1),console.log(e)}).catch(e=>{console.error(e)})},updataOrder(e){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/lili-testapi/admin/order/"+e.id;this.$http.put(t,{data:e}).then(e=>{console.log(e),e.data.success?(this.emitter.emit("pushMessage",{style:"success",content:e.data.message,icon:""}),this.$refs.detail.hideModal(),this.getOrder(),this.isLoading=!1):(this.emitter.emit("pushMessage",{style:"fail",content:e.data.message,icon:""}),this.isLoading=!1)}).catch(e=>{console.error(e)})},deleteAll(){this.isLoading=!0;const e="https://vue3-course-api.hexschool.io/api/lili-testapi/admin/orders/all";this.$http.delete(e).then(e=>{e.data.success?(this.$refs.delModal.hideModal(),this.getOrder(),this.isLoading=!1,this.emitter.emit("pushMessage",{style:"success",content:e.data.message,icon:""})):(this.emitter.emit("pushMessage",{style:"fail",content:e.data.message,icon:""}),this.$refs.delModal.hideModal(),this.isLoading=!1),console.log(e)}).catch(e=>{console.error(e)})}},mounted(){this.getOrder()}};const Ne=pe()(Ve,[["render",u]]);t["default"]=Ne}}]);
//# sourceMappingURL=chunk-2d216802.35ea0626.js.map