(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7e83ed42"],{1799:function(e,t,o){"use strict";var a=o("7a23");const c={"aria-label":"Page navigation",class:"pagination justify-content-center"},n={class:"pagination justify-content-center"},l={key:0,class:"page-item"},s=["onClick"],i={key:1,class:"page-item"};function d(e,t,o,d,r,p){const u=Object(a["resolveComponent"])("font-awesome-icon");return Object(a["openBlock"])(),Object(a["createElementBlock"])("nav",c,[Object(a["createElementVNode"])("ul",n,[1==o.page.has_pre?(Object(a["openBlock"])(),Object(a["createElementBlock"])("li",l,[Object(a["createElementVNode"])("a",{class:"page-link",href:"#",onClick:t[0]||(t[0]=Object(a["withModifiers"])(t=>e.$emit("changePage",o.page.current_page-1),["prevent"]))},[Object(a["createVNode"])(u,{icon:"fa-solid fa-angle-left"})])])):Object(a["createCommentVNode"])("",!0),(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(o.page.total_pages,t=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("li",{class:"page-item",key:t},[Object(a["createElementVNode"])("a",{class:Object(a["normalizeClass"])(["page-link",{active:t==o.page.current_page}]),href:"#",onClick:Object(a["withModifiers"])(o=>e.$emit("changePage",t),["prevent"])},Object(a["toDisplayString"])(t),11,s)]))),128)),1==o.page.has_next?(Object(a["openBlock"])(),Object(a["createElementBlock"])("li",i,[Object(a["createElementVNode"])("a",{class:"page-link",href:"#",onClick:t[1]||(t[1]=Object(a["withModifiers"])(t=>e.$emit("changePage",o.page.current_page+1),["prevent"]))},[Object(a["createVNode"])(u,{icon:"fa-solid fa-angle-right"})])])):Object(a["createCommentVNode"])("",!0)])])}var r={props:["page"]},p=o("6b0d"),u=o.n(p);const m=u()(r,[["render",d]]);t["a"]=m},ea03:function(e,t,o){"use strict";o.r(t);var a=o("7a23");const c={class:"container"},n={class:"adminInner"},l={class:"btnBox"},s={class:"pdtList"},i={class:"mt-4"},d=Object(a["createElementVNode"])("thead",null,[Object(a["createElementVNode"])("tr",null,[Object(a["createElementVNode"])("th",{width:"120"},"名稱"),Object(a["createElementVNode"])("th",{width:"120"},"折扣"),Object(a["createElementVNode"])("th",{width:"120"},"到期日"),Object(a["createElementVNode"])("th",null,"優惠序號"),Object(a["createElementVNode"])("th",null,"是否啟用"),Object(a["createElementVNode"])("th")])],-1),r={class:"btn-group"},p=["onClick"],u=["onClick"];function m(e,t,o,m,b,h){const j=Object(a["resolveComponent"])("Header"),O=Object(a["resolveComponent"])("Loading"),g=Object(a["resolveComponent"])("Pagination"),f=Object(a["resolveComponent"])("DelModal"),V=Object(a["resolveComponent"])("Coupons",!0);return Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],null,[Object(a["createVNode"])(j),Object(a["createElementVNode"])("div",c,[Object(a["createElementVNode"])("div",n,[Object(a["createElementVNode"])("div",l,[Object(a["createElementVNode"])("button",{type:"button",class:"btn btn-primary mr-2 border-start-0",onClick:t[0]||(t[0]=e=>h.opencouponsModal(!0))}," 新增優惠券 ")]),Object(a["createElementVNode"])("div",s,[Object(a["createElementVNode"])("table",i,[d,Object(a["createElementVNode"])("tbody",null,[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(b.couponList,(t,o)=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("tr",{key:o},[Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(t.title),1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(100-t.percent)+" %",1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(e.$filter.getDate(t.due_date)),1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(t.code),1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(1==t.is_enabled?"已啟用":"未啟用"),1),Object(a["createElementVNode"])("td",null,[Object(a["createElementVNode"])("div",r,[Object(a["createElementVNode"])("button",{class:"btn btn-outline-primary btn-sm","data-bs-toggle":"modal","data-bs-target":"#Modal",onClick:e=>h.opencouponsModal(!1,t)}," 編輯 ",8,p),Object(a["createElementVNode"])("button",{class:"btn btn-outline-danger btn-sm","data-bs-toggle":"modal","data-bs-target":"#delModal",onClick:e=>h.openDelModal(t)}," 刪除 ",8,u)])])]))),128))])])]),Object(a["createVNode"])(O,{isShow:b.isLoading},null,8,["isShow"]),Object(a["createVNode"])(g,{page:b.page,onChangePage:h.changePage},null,8,["page","onChangePage"]),Object(a["createVNode"])(f,{ref:"delModal",pdt:b.tempcoupon,onDelProduct:h.delcoupon},null,8,["pdt","onDelProduct"]),Object(a["createVNode"])(V,{ref:"couponsModal",couponData:b.tempcoupon,onUpdate:h.updatecoupon},null,8,["couponData","onUpdate"])])])],64)}var b=o("1985"),h=o("1799"),j=o("cb98");const O={class:"modal fade orderModal",tabindex:"-1",ref:"modal"},g={class:"modal-dialog modal-lg",role:"document"},f=Object(a["createElementVNode"])("div",{class:"modal-header"},[Object(a["createElementVNode"])("p",{class:"modalTitle"},[Object(a["createElementVNode"])("span",null,"新增/編輯優惠券")]),Object(a["createElementVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),V={class:"modal-body"},N={class:"mb-3"},E={for:"title",class:"form-label inputTitle"},k=Object(a["createTextVNode"])(" 名稱 "),v={class:"mb-3"},M={for:"percent",class:"form-label inputTitle"},w=Object(a["createTextVNode"])(" 折扣(%) "),C={class:"mb-3"},y={for:"due_date",class:"form-label inputTitle"},D=Object(a["createTextVNode"])(" 到期日 "),x={class:"mb-3"},B={for:"code",class:"form-label inputTitle"},$=Object(a["createTextVNode"])(" 優惠序號 "),_={class:"mb-3"},L={class:"form-check form-switch"},P={key:0,class:"form-check-label",for:"flexSwitchCheckDefault"},S={key:1,class:"form-check-label",for:"flexSwitchCheckDefault"},T=Object(a["createElementVNode"])("div",{class:"modal-footer"},[Object(a["createElementVNode"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 "),Object(a["createElementVNode"])("button",{class:"btn btn-primary"},"確認")],-1);function U(e,t,o,c,n,l){const s=Object(a["resolveComponent"])("font-awesome-icon"),i=Object(a["resolveComponent"])("Field"),d=Object(a["resolveComponent"])("ErrorMessage"),r=Object(a["resolveComponent"])("Form");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",O,[Object(a["createElementVNode"])("div",g,[Object(a["createVNode"])(r,{class:"modal-content border-0",onSubmit:l.onsubmit},{default:Object(a["withCtx"])(({errors:o})=>[f,Object(a["createElementVNode"])("div",V,[Object(a["createElementVNode"])("div",N,[Object(a["createElementVNode"])("label",E,[Object(a["createVNode"])(s,{icon:"fa-solid fa-stroopwafel"}),k]),Object(a["createVNode"])(i,{type:"text",class:Object(a["normalizeClass"])(["form-control",{"is-invalid":o["名稱"]}]),id:"title",modelValue:n.cupon.title,"onUpdate:modelValue":t[0]||(t[0]=e=>n.cupon.title=e),name:"名稱",rules:"required"},null,8,["modelValue","class"]),Object(a["createVNode"])(d,{name:"名稱",class:"inputNote"})]),Object(a["createElementVNode"])("div",v,[Object(a["createElementVNode"])("label",M,[Object(a["createVNode"])(s,{icon:"fa-solid fa-stroopwafel"}),w]),Object(a["createVNode"])(i,{type:"number",class:Object(a["normalizeClass"])(["form-control",{"is-invalid":o["折扣"]}]),id:"percent",modelValue:n.cupon.percent,"onUpdate:modelValue":t[1]||(t[1]=e=>n.cupon.percent=e),rules:"required|between:1,100",name:"折扣"},null,8,["modelValue","class"]),Object(a["createVNode"])(d,{name:"折扣",class:"inputNote"})]),Object(a["createElementVNode"])("div",C,[Object(a["createElementVNode"])("label",y,[Object(a["createVNode"])(s,{icon:"fa-solid fa-stroopwafel"}),D]),Object(a["createVNode"])(i,{type:"date",class:Object(a["normalizeClass"])(["form-control",{"is-invalid":o["到期日"]}]),id:"due_date",modelValue:n.cupon.due_date,"onUpdate:modelValue":t[2]||(t[2]=e=>n.cupon.due_date=e),rules:"required",name:"到期日",ref:"dateInput",min:e.$filter.getDate(new Date)},null,8,["modelValue","class","min"]),Object(a["createVNode"])(d,{name:"到期日",class:"inputNote"})]),Object(a["createElementVNode"])("div",x,[Object(a["createElementVNode"])("label",B,[Object(a["createVNode"])(s,{icon:"fa-solid fa-stroopwafel"}),$]),Object(a["createVNode"])(i,{type:"text",class:Object(a["normalizeClass"])(["form-control",{"is-invalid":o["優惠序號"]}]),id:"code",modelValue:n.cupon.code,"onUpdate:modelValue":t[3]||(t[3]=e=>n.cupon.code=e),rules:"required",name:"優惠序號"},null,8,["modelValue","class"]),Object(a["createVNode"])(d,{name:"優惠序號",class:"inputNote"})]),Object(a["createElementVNode"])("div",_,[Object(a["createElementVNode"])("div",L,[1==n.cupon.is_enabled?(Object(a["openBlock"])(),Object(a["createElementBlock"])("label",P," 已啟用 ")):(Object(a["openBlock"])(),Object(a["createElementBlock"])("label",S," 未啟用 ")),Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{"true-value":1,"false-value":0,class:"form-check-input",type:"checkbox",role:"switch",id:"flexSwitchCheckDefault","onUpdate:modelValue":t[4]||(t[4]=e=>n.cupon.is_enabled=e)},null,512),[[a["vModelCheckbox"],n.cupon.is_enabled]])])])]),T]),_:1},8,["onSubmit"])])],512)}var F=o("8ad7"),z={mixins:[F["a"]],data(){return{cupon:{}}},props:{couponData:{type:Object,defalut(){return{}}}},watch:{couponData(){this.couponData.is_enabled?this.cupon={...this.couponData,percent:100-this.couponData.percent,due_date:this.$filter.getDate(this.couponData.due_date)}:this.cupon={...this.couponData,percent:100-this.couponData.percent,is_enabled:0}}},methods:{onsubmit(){const e={...this.cupon,due_date:this.$filter.getStemp(this.cupon.due_date),percent:Number(100-this.cupon.percent)};this.$emit("update",e)}}},q=o("6b0d"),H=o.n(q);const I=H()(z,[["render",U]]);var J=I,Y=o("3a5e"),A={data(){return{couponList:[],tempcoupon:{},isLoading:!1,page:{},currentPage:1,isNew:!0}},components:{Header:b["a"],Pagination:h["a"],DelModal:j["a"],Coupons:J,Loading:Y["a"]},inject:["emitter"],methods:{openDelModal(e){this.tempcoupon=e,this.$refs.delModal.showModal()},opencouponsModal(e,t){this.isNew=e,e?this.tempcoupon={}:(this.tempcoupon=t,console.log(this.tempcoupon)),this.$refs.couponsModal.showModal()},getcoupons(){this.isLoading=!0;const e="https://vue3-course-api.hexschool.io/api/lili-testapi/admin/coupons?page="+this.currentPage;this.$http.get(e).then(e=>{e.data.success?(console.log(e.data),this.couponList=e.data.coupons,this.page=e.data.pagination,this.isLoading=!1):console.log("列表取得失敗")}).catch(e=>{console.error(e)})},updatecoupon(e){if(this.isNew){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/lili-testapi/admin/coupon",o=e;this.$http.post(t,{data:o}).then(e=>{e.data.success?(this.$refs.couponsModal.hideModal(),this.getcoupons(),this.isLoading=!1,this.emitter.emit("pushMessage",{style:"success",content:e.data.message,icon:""})):(this.$refs.couponsModal.hideModal(),this.getcoupons(),this.isLoading=!1,this.emitter.emit("pushMessage",{style:"fail",content:e.data.message,icon:"fa-solid fa-triangle-exclamation"}))}).catch(e=>{console.error(e)})}else{this.isLoading=!0;const t=e.id,o="https://vue3-course-api.hexschool.io/api/lili-testapi/admin/coupon/"+t,a=e;this.$http.put(o,{data:a}).then(e=>{e.data.success?(this.$refs.couponsModal.hideModal(),this.getcoupons(),this.isLoading=!1,this.emitter.emit("pushMessage",{style:"success",content:e.data.message,icon:""})):(this.$refs.couponsModal.hideModal(),this.getcoupons(),this.isLoading=!1,this.emitter.emit("pushMessage",{style:"fail",content:e.data.message,icon:"fa-solid fa-triangle-exclamation"}))}).catch(e=>{console.error(e)})}},delcoupon(e){this.isLoading=!0;const t=e.id,o="https://vue3-course-api.hexschool.io/api/lili-testapi/admin/coupon/"+t;this.$http.delete(o).then(e=>{e.data.success?(this.$refs.delModal.hideModal(),this.getcoupons(),this.isLoading=!1,this.emitter.emit("pushMessage",{style:"success",content:e.data.message,icon:""})):(this.$refs.delModal.hideModal(),this.isLoading=!1,this.emitter.emit("pushMessage",{style:"fail",content:e.data.message,icon:"fa-solid fa-triangle-exclamation"}))}).catch(e=>{console.error(e)})},getDate(e){const t=new Date(e);return`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`},changePage(e){this.currentPage=e,this.getcoupons()}},mounted(){this.getcoupons()}};const G=H()(A,[["render",m]]);t["default"]=G}}]);
//# sourceMappingURL=chunk-7e83ed42.0229f1a6.js.map