(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-21eabfbd"],{1799:function(e,t,o){"use strict";var a=o("7a23");const c={"aria-label":"Page navigation",class:"pagination justify-content-center"},n={class:"pagination justify-content-center"},l={key:0,class:"page-item"},s=["onClick"],i={key:1,class:"page-item"};function d(e,t,o,d,r,b){const m=Object(a["resolveComponent"])("font-awesome-icon");return Object(a["openBlock"])(),Object(a["createElementBlock"])("nav",c,[Object(a["createElementVNode"])("ul",n,[1==o.page.has_pre?(Object(a["openBlock"])(),Object(a["createElementBlock"])("li",l,[Object(a["createElementVNode"])("a",{class:"page-link",href:"#",onClick:t[0]||(t[0]=Object(a["withModifiers"])(t=>e.$emit("changePage",o.page.current_page-1),["prevent"]))},[Object(a["createVNode"])(m,{icon:"fa-solid fa-angle-left"})])])):Object(a["createCommentVNode"])("",!0),(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(o.page.total_pages,t=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("li",{class:"page-item",key:t},[Object(a["createElementVNode"])("a",{class:Object(a["normalizeClass"])(["page-link",{active:t==o.page.current_page}]),href:"#",onClick:Object(a["withModifiers"])(o=>e.$emit("changePage",t),["prevent"])},Object(a["toDisplayString"])(t),11,s)]))),128)),1==o.page.has_next?(Object(a["openBlock"])(),Object(a["createElementBlock"])("li",i,[Object(a["createElementVNode"])("a",{class:"page-link",href:"#",onClick:t[1]||(t[1]=Object(a["withModifiers"])(t=>e.$emit("changePage",o.page.current_page+1),["prevent"]))},[Object(a["createVNode"])(m,{icon:"fa-solid fa-angle-right"})])])):Object(a["createCommentVNode"])("",!0)])])}var r={props:["page"]},b=o("6b0d"),m=o.n(b);const p=m()(r,[["render",d]]);t["a"]=p},cb98:function(e,t,o){"use strict";var a=o("7a23");const c={class:"modal fade",tabindex:"-1",ref:"modal"},n={class:"modal-dialog"},l={class:"modal-content"},s={class:"modal-header"},i={class:"modal-title"},d=Object(a["createTextVNode"])(" 提示 "),r=Object(a["createElementVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),b={class:"modal-body"},m={class:"modal-footer"},p=Object(a["createElementVNode"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function u(e,t,o,u,h,j){const O=Object(a["resolveComponent"])("font-awesome-icon");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",c,[Object(a["createElementVNode"])("div",n,[Object(a["createElementVNode"])("div",l,[Object(a["createElementVNode"])("div",s,[Object(a["createElementVNode"])("h5",i,[Object(a["createVNode"])(O,{icon:"fa-solid fa-circle-exclamation"}),d]),r]),Object(a["createElementVNode"])("div",b,[Object(a["createElementVNode"])("p",null,"您確定要刪除"+Object(a["toDisplayString"])(o.pdt.title)+"嗎?",1)]),Object(a["createElementVNode"])("div",m,[p,Object(a["createElementVNode"])("button",{type:"button",class:"btn btn-primary",onClick:t[0]||(t[0]=t=>e.$emit("delProduct",o.pdt))}," 確定 ")])])])],512)}var h=o("8ad7"),j={mixins:[h["a"]],props:["pdt"]},O=o("6b0d"),g=o.n(O);const V=g()(j,[["render",u]]);t["a"]=V},ea03:function(e,t,o){"use strict";o.r(t);var a=o("7a23");const c={class:"container"},n={class:"adminInner"},l={class:"pdtSearchBox"},s={class:"btnBox"},i=Object(a["createElementVNode"])("input",{type:"text",placeholder:"請輸入優惠序號"},null,-1),d={type:"button",class:"btn btn-primary mr-2 border-start-0"},r={class:"btnBox"},b={class:"pdtList"},m={class:"mt-4"},p=Object(a["createElementVNode"])("thead",null,[Object(a["createElementVNode"])("tr",null,[Object(a["createElementVNode"])("th",{width:"120"},"名稱"),Object(a["createElementVNode"])("th",{width:"120"},"折扣"),Object(a["createElementVNode"])("th",{width:"120"},"到期日"),Object(a["createElementVNode"])("th",null,"優惠序號"),Object(a["createElementVNode"])("th",null,"是否啟用"),Object(a["createElementVNode"])("th")])],-1),u={class:"btn-group"},h=["onClick"],j=["onClick"];function O(e,t,o,O,g,V){const N=Object(a["resolveComponent"])("Header"),f=Object(a["resolveComponent"])("font-awesome-icon"),E=Object(a["resolveComponent"])("Loading"),v=Object(a["resolveComponent"])("Pagination"),k=Object(a["resolveComponent"])("DelModal"),y=Object(a["resolveComponent"])("Coupons",!0);return Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],null,[Object(a["createVNode"])(N),Object(a["createElementVNode"])("div",c,[Object(a["createElementVNode"])("div",n,[Object(a["createElementVNode"])("div",l,[Object(a["createElementVNode"])("div",s,[i,Object(a["createElementVNode"])("button",d,[Object(a["createVNode"])(f,{icon:"fa-solid fa-magnifying-glass"})])])]),Object(a["createElementVNode"])("div",r,[Object(a["createElementVNode"])("button",{type:"button",class:"btn btn-primary mr-2 border-start-0",onClick:t[0]||(t[0]=e=>V.opencouponsModal(!0))}," 新增優惠券 ")]),Object(a["createElementVNode"])("div",b,[Object(a["createElementVNode"])("table",m,[p,Object(a["createElementVNode"])("tbody",null,[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(g.couponList,(t,o)=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("tr",{key:o},[Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(t.title),1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(100-t.percent)+" %",1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(e.$filter.getDate(t.due_date)),1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(t.code),1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(1==t.is_enabled?"已啟用":"未啟用"),1),Object(a["createElementVNode"])("td",null,[Object(a["createElementVNode"])("div",u,[Object(a["createElementVNode"])("button",{class:"btn btn-outline-primary btn-sm","data-bs-toggle":"modal","data-bs-target":"#Modal",onClick:e=>V.opencouponsModal(!1,t)}," 編輯 ",8,h),Object(a["createElementVNode"])("button",{class:"btn btn-outline-danger btn-sm","data-bs-toggle":"modal","data-bs-target":"#delModal",onClick:e=>V.openDelModal(t)}," 刪除 ",8,j)])])]))),128))])])]),Object(a["createVNode"])(E,{isShow:g.isLoading},null,8,["isShow"]),Object(a["createVNode"])(v,{page:g.page,onChangePage:V.changePage},null,8,["page","onChangePage"]),Object(a["createVNode"])(k,{ref:"delModal",pdt:g.tempcoupon,onDelProduct:V.delcoupon},null,8,["pdt","onDelProduct"]),Object(a["createVNode"])(y,{ref:"couponsModal",couponData:g.tempcoupon,onUpdate:V.updatecoupon},null,8,["couponData","onUpdate"])])])],64)}var g=o("1985"),V=o("1799"),N=o("cb98");const f={class:"modal fade orderModal",tabindex:"-1",ref:"modal"},E={class:"modal-dialog modal-lg",role:"document"},v=Object(a["createElementVNode"])("div",{class:"modal-header"},[Object(a["createElementVNode"])("p",{class:"modalTitle"},[Object(a["createElementVNode"])("span",null,"新增/編輯優惠券")]),Object(a["createElementVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),k={class:"modal-body"},y={class:"mb-3"},M=Object(a["createElementVNode"])("label",{for:"title",class:"form-label"}," 名稱 ",-1),C={class:"mb-3"},w=Object(a["createElementVNode"])("label",{for:"percent",class:"form-label"}," 折扣(%) ",-1),D={class:"mb-3"},B=Object(a["createElementVNode"])("label",{for:"due_date",class:"form-label"}," 到期日 ",-1),x={class:"mb-3"},$=Object(a["createElementVNode"])("label",{for:"code",class:"form-label"}," 優惠序號 ",-1),_={class:"mb-3"},L={class:"form-check form-switch"},P={key:0,class:"form-check-label",for:"flexSwitchCheckDefault"},S={key:1,class:"form-check-label",for:"flexSwitchCheckDefault"},U=Object(a["createElementVNode"])("div",{class:"modal-footer"},[Object(a["createElementVNode"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 "),Object(a["createElementVNode"])("button",{class:"btn btn-primary"},"確認")],-1);function F(e,t,o,c,n,l){const s=Object(a["resolveComponent"])("Field"),i=Object(a["resolveComponent"])("ErrorMessage"),d=Object(a["resolveComponent"])("Form");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",f,[Object(a["createElementVNode"])("div",E,[Object(a["createVNode"])(d,{class:"modal-content border-0",onSubmit:l.onsubmit},{default:Object(a["withCtx"])(({errors:o})=>[v,Object(a["createElementVNode"])("div",k,[Object(a["createElementVNode"])("div",y,[M,Object(a["createVNode"])(s,{type:"text",class:Object(a["normalizeClass"])(["form-control",{"is-invalid":o["名稱"]}]),id:"title",modelValue:n.cupon.title,"onUpdate:modelValue":t[0]||(t[0]=e=>n.cupon.title=e),name:"名稱",rules:"required"},null,8,["modelValue","class"]),Object(a["createVNode"])(i,{name:"名稱",class:"inputNote"})]),Object(a["createElementVNode"])("div",C,[w,Object(a["createVNode"])(s,{type:"number",class:Object(a["normalizeClass"])(["form-control",{"is-invalid":o["折扣"]}]),id:"percent",modelValue:n.cupon.percent,"onUpdate:modelValue":t[1]||(t[1]=e=>n.cupon.percent=e),rules:"required|between:1,100",name:"折扣"},null,8,["modelValue","class"]),Object(a["createVNode"])(i,{name:"折扣",class:"inputNote"})]),Object(a["createElementVNode"])("div",D,[B,Object(a["createVNode"])(s,{type:"date",class:Object(a["normalizeClass"])(["form-control",{"is-invalid":o["到期日"]}]),id:"due_date",modelValue:n.cupon.due_date,"onUpdate:modelValue":t[2]||(t[2]=e=>n.cupon.due_date=e),rules:"required",name:"到期日",ref:"dateInput",min:e.$filter.getDate(new Date)},null,8,["modelValue","class","min"]),Object(a["createVNode"])(i,{name:"到期日",class:"inputNote"})]),Object(a["createElementVNode"])("div",x,[$,Object(a["createVNode"])(s,{type:"text",class:Object(a["normalizeClass"])(["form-control",{"is-invalid":o["優惠序號"]}]),id:"code",modelValue:n.cupon.code,"onUpdate:modelValue":t[3]||(t[3]=e=>n.cupon.code=e),rules:"required",name:"優惠序號"},null,8,["modelValue","class"]),Object(a["createVNode"])(i,{name:"優惠序號",class:"inputNote"})]),Object(a["createElementVNode"])("div",_,[Object(a["createElementVNode"])("div",L,[1==n.cupon.is_enabled?(Object(a["openBlock"])(),Object(a["createElementBlock"])("label",P," 已啟用 ")):(Object(a["openBlock"])(),Object(a["createElementBlock"])("label",S," 未啟用 ")),Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{"true-value":1,"false-value":0,class:"form-check-input",type:"checkbox",role:"switch",id:"flexSwitchCheckDefault","onUpdate:modelValue":t[4]||(t[4]=e=>n.cupon.is_enabled=e)},null,512),[[a["vModelCheckbox"],n.cupon.is_enabled]])])])]),U]),_:1},8,["onSubmit"])])],512)}var z=o("8ad7"),q={mixins:[z["a"]],data(){return{cupon:{}}},props:{couponData:{type:Object,defalut(){return{}}}},watch:{couponData(){this.couponData.is_enabled?this.cupon={...this.couponData,due_date:this.$filter.getDate(this.couponData.due_date)}:this.cupon={...this.couponData,is_enabled:0}}},methods:{onsubmit(){const e={...this.cupon,due_date:this.$filter.getStemp(this.cupon.due_date),percent:Number(100-this.cupon.percent)};this.$emit("update",e)}}},H=o("6b0d"),I=o.n(H);const J=I()(q,[["render",F]]);var T=J,Y=o("3a5e"),A={data(){return{couponList:[],tempcoupon:{},isLoading:!1,page:{},currentPage:1,isNew:!0}},components:{Header:g["a"],Pagination:V["a"],DelModal:N["a"],Coupons:T,Loading:Y["a"]},inject:["emitter"],methods:{openDelModal(e){this.tempcoupon=e,this.$refs.delModal.showModal()},opencouponsModal(e,t){this.isNew=e,e?this.tempcoupon={}:(this.tempcoupon=t,console.log(this.tempcoupon)),this.$refs.couponsModal.showModal()},getcoupons(){this.isLoading=!0;const e="https://vue3-course-api.hexschool.io/api/lili-testapi/admin/coupons?page="+this.currentPage;this.$http.get(e).then(e=>{e.data.success?(console.log(e.data),this.couponList=e.data.coupons,this.page=e.data.pagination,this.isLoading=!1):console.log("列表取得失敗")}).catch(e=>{console.error(e)})},updatecoupon(e){if(this.isNew){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/lili-testapi/admin/coupon",o=e;this.$http.post(t,{data:o}).then(e=>{e.data.success?(this.$refs.couponsModal.hideModal(),this.getcoupons(),this.isLoading=!1,this.emitter.emit("pushMessage",{style:"success",content:e.data.message,icon:""})):(this.$refs.couponsModal.hideModal(),this.getcoupons(),this.isLoading=!1,this.emitter.emit("pushMessage",{style:"fail",content:e.data.message,icon:"fa-solid fa-triangle-exclamation"}))}).catch(e=>{console.error(e)})}else{this.isLoading=!0;const t=e.id,o="https://vue3-course-api.hexschool.io/api/lili-testapi/admin/coupon/"+t,a=e;this.$http.put(o,{data:a}).then(e=>{e.data.success?(this.$refs.couponsModal.hideModal(),this.getcoupons(),this.isLoading=!1,this.emitter.emit("pushMessage",{style:"success",content:e.data.message,icon:""})):(this.$refs.couponsModal.hideModal(),this.getcoupons(),this.isLoading=!1,this.emitter.emit("pushMessage",{style:"fail",content:e.data.message,icon:"fa-solid fa-triangle-exclamation"}))}).catch(e=>{console.error(e)})}},delcoupon(e){this.isLoading=!0;const t=e.id,o="https://vue3-course-api.hexschool.io/api/lili-testapi/admin/coupon/"+t;this.$http.delete(o).then(e=>{e.data.success?(this.$refs.delModal.hideModal(),this.getcoupons(),this.isLoading=!1,this.emitter.emit("pushMessage",{style:"success",content:e.data.message,icon:""})):(this.$refs.delModal.hideModal(),this.isLoading=!1,this.emitter.emit("pushMessage",{style:"fail",content:e.data.message,icon:"fa-solid fa-triangle-exclamation"}))}).catch(e=>{console.error(e)})},getDate(e){const t=new Date(e);return`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`},changePage(e){this.currentPage=e,this.getcoupons()}},mounted(){this.getcoupons()}};const G=I()(A,[["render",O]]);t["default"]=G}}]);
//# sourceMappingURL=chunk-21eabfbd.4671806b.js.map